<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé¨ Viral Content Creator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        body {
            font-family: -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            min-height: 100vh;
            padding: 15px;
            color: #fff
        }

        .container {
            max-width: 900px;
            margin: 0 auto
        }

        .header {
            text-align: center;
            margin-bottom: 20px
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 6px
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 10px;
            background: linear-gradient(90deg, #00b894, #00cec9);
            margin-bottom: 8px
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 12px
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 15px
        }

        .cat-btn {
            padding: 12px 8px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid transparent;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 11px
        }

        .cat-btn:hover {
            background: rgba(255, 255, 255, 0.15)
        }

        .cat-btn.active {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.2)
        }

        .cat-btn .icon {
            font-size: 24px;
            display: block;
            margin-bottom: 4px
        }

        .input-group {
            margin-bottom: 10px
        }

        .input-group label {
            display: block;
            margin-bottom: 3px;
            font-size: 12px;
            opacity: 0.8
        }

        .input-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            font-size: 12px
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #00b894, #00cec9);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer
        }

        .btn:hover {
            transform: scale(1.02)
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none
        }

        .step {
            padding: 8px 10px;
            margin: 5px 0;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            border-left: 3px solid #333;
            display: flex;
            align-items: center;
            font-size: 12px
        }

        .step.active {
            border-color: #f39c12;
            background: rgba(243, 156, 18, 0.1)
        }

        .step.done {
            border-color: #00b894;
            background: rgba(0, 184, 148, 0.1)
        }

        .step-icon {
            font-size: 16px;
            margin-right: 8px
        }

        .output-box {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            margin-top: 12px
        }

        .config-toggle {
            background: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 10px;
            margin-bottom: 10px
        }

        .config-panel {
            display: none;
            margin-bottom: 12px
        }

        .config-panel.show {
            display: block
        }

        .content-section {
            background: rgba(255, 255, 255, 0.03);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px
        }

        .content-section h4 {
            color: #00b894;
            margin-bottom: 8px;
            font-size: 13px
        }

        .media-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px
        }

        .media-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 12px;
            border-radius: 10px;
            text-align: center
        }

        .media-card canvas {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 8px
        }

        .media-card h5 {
            font-size: 12px;
            margin-bottom: 8px;
            color: #00b894
        }

        .audio-btn {
            padding: 10px 15px;
            background: #00b894;
            border: none;
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 12px;
            margin: 3px
        }

        .audio-btn:hover {
            background: #00a884
        }

        .audio-btn.stop {
            background: #e74c3c
        }

        .audio-btn.download {
            background: #6c5ce7
        }

        .script-box {
            background: #000;
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.8;
            color: #0f0;
            white-space: pre-wrap
        }

        .caption-box {
            background: rgba(0, 0, 0, 0.5);
            padding: 12px;
            border-radius: 8px;
            font-size: 13px;
            line-height: 1.6;
            color: #fff;
            white-space: pre-wrap
        }

        .copy-btn {
            padding: 8px 15px;
            background: #6c5ce7;
            border: none;
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 11px;
            margin-top: 8px;
            margin-right: 5px
        }

        .hashtags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px
        }

        .hashtag {
            background: rgba(0, 184, 148, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px
        }

        .question-box {
            background: rgba(0, 184, 148, 0.15);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 15px;
            text-align: center
        }

        @media(max-width:600px) {
            .category-grid {
                grid-template-columns: repeat(2, 1fr)
            }

            .media-section {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <span class="badge">ü§ñ FULL AUTOMATION 2025</span>
            <h1>üé¨ Viral Content Creator</h1>
            <p style="opacity:0.6;font-size:12px">Soru + Ses + G√∂rsel + Caption = Viral Reels</p>
        </div>

        <div class="panel">
            <h4 style="margin-bottom:10px;font-size:13px">üìÇ Kategori Se√ß</h4>
            <div class="category-grid">
                <button class="cat-btn active" data-cat="kuafor"><span class="icon">üíá</span>Kuaf√∂r</button>
                <button class="cat-btn" data-cat="ai"><span class="icon">ü§ñ</span>Yapay Zeka</button>
                <button class="cat-btn" data-cat="bilim"><span class="icon">üî¨</span>Bilim</button>
                <button class="cat-btn" data-cat="fitness"><span class="icon">üí™</span>Fitness</button>
                <button class="cat-btn" data-cat="finans"><span class="icon">üí∞</span>Finans</button>
                <button class="cat-btn" data-cat="yemek"><span class="icon">üç≥</span>Yemek</button>
                <button class="cat-btn" data-cat="sanat"><span class="icon">üé®</span>Sanat</button>
                <button class="cat-btn" data-cat="gelisim"><span class="icon">üßò</span>Geli≈üim</button>
                <button class="cat-btn" data-cat="gizlitarih"><span class="icon">üóø</span>Gizli Tarih</button>
            </div>
        </div>

        <div class="panel">
            <button class="config-toggle" onclick="toggleConfig()">‚öôÔ∏è API Token</button>
            <div class="config-panel" id="configPanel">
                <div class="input-group">
                    <label>üîë <a href="https://huggingface.co/settings/tokens" target="_blank"
                            style="color:#00b894">HuggingFace Token</a></label>
                    <input type="password" id="tokenInput" placeholder="hf_xxxxxxxxxxxxx">
                </div>
                <button onclick="saveToken()"
                    style="padding:6px 12px;background:#00b894;border:none;border-radius:5px;color:#fff;cursor:pointer;font-size:11px">üíæ
                    Kaydet</button>
            </div>
            <button class="btn" id="startBtn" onclick="runWorkflow()">üöÄ Vƒ∞RAL ƒ∞√áERƒ∞K OLU≈ûTUR</button>
        </div>

        <div class="panel" id="stepsPanel" style="display:none">
            <div class="step" id="s1"><span class="step-icon">‚ùì</span>Trend Soru Bulunuyor</div>
            <div class="step" id="s2"><span class="step-icon">üéôÔ∏è</span>Seslendirme Metni Yazƒ±lƒ±yor</div>
            <div class="step" id="s3"><span class="step-icon">üñºÔ∏è</span>G√∂rsel Olu≈üturuluyor</div>
            <div class="step" id="s4"><span class="step-icon">üìù</span>Caption & Hashtag</div>
        </div>

        <div class="output-box" id="outputBox" style="display:none">

            <div class="question-box" id="questionBox"></div>

            <div class="media-section">
                <div class="media-card">
                    <h5>üñºÔ∏è G√∂rsel (Soru + CTA)</h5>
                    <canvas id="finalCanvas" width="540" height="960"></canvas>
                    <button class="audio-btn download" onclick="downloadImage()">üì• G√∂rseli ƒ∞ndir</button>
                </div>
                <div class="media-card">
                    <h5>üîä Seslendirme</h5>
                    <button class="audio-btn" onclick="speakScript()">‚ñ∂Ô∏è Dinle</button>
                    <button class="audio-btn stop" onclick="stopSpeech()">‚èπÔ∏è Durdur</button>
                    <p style="font-size:10px;opacity:0.5;margin-top:8px">T√ºrk√ße doƒüal ses</p>
                    <div style="margin-top:10px">
                        <label style="font-size:10px">Hƒ±z:</label>
                        <input type="range" id="speedRange" min="0.7" max="1.0" step="0.05" value="0.85"
                            style="width:80%">
                    </div>
                </div>
            </div>

            <div class="content-section">
                <h4>üéôÔ∏è Seslendirme Metni</h4>
                <div class="script-box" id="scriptBox"></div>
                <button class="copy-btn" onclick="copyScript()">üìã Kopyala</button>
            </div>

            <div class="content-section">
                <h4>üìù Instagram Caption</h4>
                <div class="caption-box" id="captionBox"></div>
                <button class="copy-btn" onclick="copyCaption()">üìã Kopyala</button>
            </div>

            <div class="content-section">
                <h4>üè∑Ô∏è Hashtags</h4>
                <div class="hashtags" id="hashtagBox"></div>
                <p id="bestTime" style="font-size:11px;margin-top:10px;opacity:0.7"></p>
            </div>
        </div>
    </div>

    <script>
        const API = 'https://router.huggingface.co/v1/chat/completions';
        let selectedCategory = 'kuafor';
        let currentScript = '';
        let currentQuestion = '';
        let currentCaption = '';

        document.querySelectorAll('.cat-btn').forEach(btn => {
            btn.onclick = () => {
                document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedCategory = btn.dataset.cat;
            };
        });

        function toggleConfig() { document.getElementById('configPanel').classList.toggle('show'); }
        function saveToken() { localStorage.setItem('hf_token', document.getElementById('tokenInput').value); alert('‚úÖ Kaydedildi!'); toggleConfig(); }
        function getToken() { return localStorage.getItem('hf_token') || ''; }
        window.onload = () => { if (getToken()) document.getElementById('tokenInput').value = getToken(); }

        const CATEGORIES = {
            kuafor: {
                name: 'Sa√ß Bakƒ±mƒ±',
                color: '#e84393',
                questionPrompt: `2025 yƒ±lƒ±nda T√úRKƒ∞YE'de Google ve Instagram'da sa√ß bakƒ±mƒ± ve kuaf√∂rl√ºk konusunda EN √áOK SORULAN ve Reels formatƒ±na uygun Bƒ∞R soru √ºret.

KURALLAR:
- Soru mutlaka "2025" i√ßersin
- Liste veya net sonu√ß vaadi olsun (5 adƒ±m, 3 hata, 1 ger√ßek gibi)
- Ombre, balyaj, boya, sa√ß bakƒ±mƒ± gibi kelimelerden biri ge√ßsin
- Instagram Reels'de durdurma etkisi olsun
- TEK soru yaz
- A√ßƒ±klama YAZMA

√ñRNEK TARZ (AYNISINI YAZMA):
"2025'te ombreli sa√ßlar i√ßin yapƒ±lmasƒ± gereken 5 bakƒ±m adƒ±mƒ± nedir?"`,
                imagePrompt: 'professional hair salon, beautiful healthy shiny hair, ombre balayage styling, modern aesthetic, soft lighting, no text'
            },
            ai: {
                name: 'Yapay Zeka',
                color: '#0984e3',
                questionPrompt: `2025 yƒ±lƒ±nda yapay zeka konusunda insanlarƒ±n EN √áOK merak ettiƒüi ve Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- "2025" veya "yeni" ge√ßsin
- Liste vaadi olsun (5 ara√ß, 3 tehlike, 1 sƒ±r gibi)
- ChatGPT, AI, yapay zeka kelimelerinden biri ge√ßsin
- Durdurma etkisi olsun
- TEK soru yaz`,
                imagePrompt: 'futuristic AI technology, neural network visualization, blue neon glow, modern tech, no text'
            },
            bilim: {
                name: 'Bilim',
                color: '#6c5ce7',
                questionPrompt: `Bilim d√ºnyasƒ±nda insanlarƒ±n bilmesi gereken ama genelde yanlƒ±≈ü bilinen, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- ≈ûa≈üƒ±rtƒ±cƒ± veya ilgin√ß olsun
- Liste vaadi olsun (5 ger√ßek, 3 yanlƒ±≈ü gibi)
- Durdurma etkisi olsun
- TEK soru yaz`,
                imagePrompt: 'science discovery, space universe, laboratory research, cosmic aesthetic, no text'
            },
            fitness: {
                name: 'Fitness',
                color: '#00b894',
                questionPrompt: `2025 yƒ±lƒ±nda fitness konusunda herkesin yaptƒ±ƒüƒ± ama yanlƒ±≈ü olan, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- "2025" ge√ßsin
- Liste vaadi olsun (5 hata, 3 ipucu gibi)
- Egzersiz, kilo, kas kelimelerinden biri ge√ßsin
- TEK soru yaz`,
                imagePrompt: 'fitness workout, athletic training, modern gym, strong body, dynamic pose, no text'
            },
            finans: {
                name: 'Finans',
                color: '#fdcb6e',
                questionPrompt: `2025 yƒ±lƒ±nda para ve yatƒ±rƒ±m konusunda herkesin bilmesi gereken, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- "2025" ge√ßsin
- Liste vaadi olsun (5 hata, 3 yatƒ±rƒ±m gibi)
- Para, yatƒ±rƒ±m, tasarruf kelimelerinden biri ge√ßsin
- TEK soru yaz`,
                imagePrompt: 'financial success, money growth, dark luxury aesthetic, gold accents, no text'
            },
            yemek: {
                name: 'Yemek',
                color: '#e17055',
                questionPrompt: `Mutfakta herkesin yaptƒ±ƒüƒ± ama yanlƒ±≈ü olan, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- ≈ûa≈üƒ±rtƒ±cƒ± olsun
- Liste vaadi olsun (5 hata, 3 ipucu gibi)
- Yemek, tarif, mutfak kelimelerinden biri ge√ßsin
- TEK soru yaz`,
                imagePrompt: 'gourmet food photography, delicious meal, kitchen art, cinematic lighting, no text'
            },
            sanat: {
                name: 'Sanat',
                color: '#fd79a8',
                questionPrompt: `Sanat ve yaratƒ±cƒ±lƒ±k konusunda √ßoƒüu ki≈üinin fark etmediƒüi, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- ƒ∞lgin√ß ve d√º≈ü√ºnd√ºr√ºc√º olsun
- Liste vaadi olsun
- Tasarƒ±m, sanat, yaratƒ±cƒ±lƒ±k ge√ßsin
- TEK soru yaz`,
                imagePrompt: 'creative art design, abstract colorful painting, modern aesthetic, artistic inspiration, no text'
            },
            gelisim: {
                name: 'Ki≈üisel Geli≈üim',
                color: '#00cec9',
                questionPrompt: `Ki≈üisel geli≈üimde s√ºrekli anlatƒ±lan ama yanlƒ±≈ü anla≈üƒ±lan, Reels'de viral olabilecek Bƒ∞R soru √ºret.

KURALLAR:
- D√º≈ü√ºnd√ºr√ºc√º olsun
- Liste vaadi olsun (5 hata, 3 alƒ±≈ükanlƒ±k gibi)
- Motivasyon, √ºretkenlik, ba≈üarƒ± ge√ßsin
- TEK soru yaz`,
                imagePrompt: 'personal growth mindset, calm power, success lifestyle, modern aesthetic, no text'
            },
            gizlitarih: {
                name: 'Gizli Tarih',
                color: '#636e72',
                questionPrompt: `Resmi tarihle √ßeli≈üen, insanlarƒ±n duyunca rahatsƒ±z olacaƒüƒ± ama ger√ßek verilere dayanan TEK bir soru yaz.

KURALLAR:
- Komplo dili kullanma
- Uzaylƒ± deme
- Keskin ve net sor
- Liste vaadi olsun
- TEK soru yaz`,
                imagePrompt: 'ancient ruins, lost civilizations, dark mystery, stone textures, archaeological discovery, cinematic light, no text'
            }
        };

        async function callAI(prompt) {
            const res = await fetch(API, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${getToken()}`, 'Content-Type': 'application/json' },
                body: JSON.stringify({ model: 'google/gemma-2-2b-it', messages: [{ role: 'user', content: prompt }], max_tokens: 700, temperature: 0.75 })
            });
            const data = await res.json();
            if (data.error) throw new Error(data.error);
            return data.choices?.[0]?.message?.content || '';
        }

        async function generateImage(prompt) {
            try {
                const res = await fetch('https://router.huggingface.co/hf-inference/models/stabilityai/stable-diffusion-xl-base-1.0', {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${getToken()}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ inputs: prompt })
                });
                if (!res.ok) return null;
                return URL.createObjectURL(await res.blob());
            } catch { return null; }
        }

        function createFinalImage(baseImageUrl, question, cat) {
            const canvas = document.getElementById('finalCanvas');
            const ctx = canvas.getContext('2d');

            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#1a1a2e');
            gradient.addColorStop(1, '#16213e');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (baseImageUrl) {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => {
                    const aspectRatio = img.width / img.height;
                    let drawWidth = canvas.width - 40;
                    let drawHeight = drawWidth / aspectRatio;
                    if (drawHeight > 480) { drawHeight = 480; drawWidth = drawHeight * aspectRatio; }
                    const x = (canvas.width - drawWidth) / 2;
                    ctx.drawImage(img, x, 180, drawWidth, drawHeight);
                    addOverlays(ctx, canvas, question, cat);
                };
                img.onerror = () => addOverlays(ctx, canvas, question, cat);
                img.src = baseImageUrl;
            } else {
                addOverlays(ctx, canvas, question, cat);
            }
        }

        function addOverlays(ctx, canvas, question, cat) {
            // Category badge
            ctx.fillStyle = cat.color;
            roundRect(ctx, 20, 20, 180, 32, 16);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 13px Arial';
            ctx.fillText('‚ùì ' + cat.name.toUpperCase(), 35, 42);

            // Question at top
            ctx.fillStyle = 'rgba(0,0,0,0.75)';
            roundRect(ctx, 20, 65, canvas.width - 40, 100, 12);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            wrapText(ctx, question, canvas.width / 2, 100, canvas.width - 60, 26);
            ctx.textAlign = 'left';

            // CTA at bottom
            ctx.fillStyle = cat.color;
            roundRect(ctx, 30, canvas.height - 160, canvas.width - 60, 80, 12);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('üí° Cevap i√ßin sesi a√ß!', canvas.width / 2, canvas.height - 130);
            ctx.font = 'bold 16px Arial';
            ctx.fillText('Kaydet, lazƒ±m olacak!', canvas.width / 2, canvas.height - 100);

            // Footer
            ctx.font = '14px Arial';
            ctx.fillStyle = 'rgba(255,255,255,0.7)';
            ctx.fillText('üíæ Kaydet  ‚Ä¢  üëÜ Takip Et  ‚Ä¢  üì§ Payla≈ü', canvas.width / 2, canvas.height - 30);
            ctx.textAlign = 'left';
        }

        function roundRect(ctx, x, y, w, h, r) {
            ctx.beginPath();
            ctx.moveTo(x + r, y);
            ctx.lineTo(x + w - r, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + r);
            ctx.lineTo(x + w, y + h - r);
            ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
            ctx.lineTo(x + r, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - r);
            ctx.lineTo(x, y + r);
            ctx.quadraticCurveTo(x, y, x + r, y);
            ctx.closePath();
        }

        function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
            const words = text.split(' ');
            let line = '';
            for (let n = 0; n < words.length; n++) {
                const testLine = line + words[n] + ' ';
                if (ctx.measureText(testLine).width > maxWidth && n > 0) {
                    ctx.fillText(line.trim(), x, y);
                    line = words[n] + ' ';
                    y += lineHeight;
                } else {
                    line = testLine;
                }
            }
            ctx.fillText(line.trim(), x, y);
        }

        function speakScript() {
            if (!currentScript) return;
            speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(currentScript);
            u.lang = 'tr-TR';
            u.rate = parseFloat(document.getElementById('speedRange').value);
            u.pitch = 1.0;
            speechSynthesis.speak(u);
        }

        function stopSpeech() { speechSynthesis.cancel(); }

        function copyScript() {
            navigator.clipboard.writeText(currentScript);
            alert('‚úÖ Seslendirme metni kopyalandƒ±!');
        }

        function copyCaption() {
            const hashtags = document.getElementById('hashtagBox').textContent;
            navigator.clipboard.writeText(currentCaption + '\n\n' + hashtags);
            alert('‚úÖ Caption + Hashtag kopyalandƒ±!');
        }

        function downloadImage() {
            const canvas = document.getElementById('finalCanvas');
            const link = document.createElement('a');
            link.download = `viral_reels_${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        async function runWorkflow() {
            if (!getToken()) { alert('‚ö†Ô∏è Token girin!'); toggleConfig(); return; }

            const btn = document.getElementById('startBtn');
            const cat = CATEGORIES[selectedCategory];

            btn.disabled = true;
            btn.textContent = '‚è≥ Olu≈üturuluyor...';
            document.getElementById('stepsPanel').style.display = 'block';
            document.getElementById('outputBox').style.display = 'none';
            ['s1', 's2', 's3', 's4'].forEach(id => document.getElementById(id).className = 'step');

            try {
                // STEP 1: Find viral question
                document.getElementById('s1').className = 'step active';
                currentQuestion = await callAI(cat.questionPrompt);
                currentQuestion = currentQuestion.replace(/[\*\#\"\']/g, '').trim();
                if (!currentQuestion.endsWith('?')) currentQuestion += '?';
                document.getElementById('s1').className = 'step done';
                await sleep(800);

                // STEP 2: Write voiceover script
                document.getElementById('s2').className = 'step active';
                const answerPrompt = `Bu sorunun cevabƒ±nƒ± SADECE SESLENDƒ∞RME i√ßin yaz:

"${currentQuestion}"

KURALLAR:
- Liste dili kullan (Birincisi..., ƒ∞kincisi...)
- 5 maddeyi 1-2 c√ºmleyle anlat
- Profesyonel ${cat.name.toLowerCase()} uzmanƒ± aƒüzƒ± kullan
- Detay VAR ama √∂ƒüretmen gibi deƒüil
- Yazƒ±da kullanƒ±lacaƒüƒ±nƒ± d√º≈ü√ºnme
- "Kaydet, √ß√ºnk√º lazƒ±m olacak." c√ºmlesiyle bitir
- Emojisiz
- Madde numarasƒ± yazma
- Parantez, y√∂nerge, "Hook", "CTA" YAZMA`;

                currentScript = await callAI(answerPrompt);
                currentScript = currentScript
                    .replace(/[\*\#\[\]\(\)\"]/g, '')
                    .replace(/\d+-\d+\s*(sn|saniye)/gi, '')
                    .replace(/Hook|CTA|ƒ∞√ßerik|G√∂r√ºnt√º|Ses|Kamera/gi, '')
                    .trim();
                document.getElementById('s2').className = 'step done';
                await sleep(800);

                // STEP 3: Generate image
                document.getElementById('s3').className = 'step active';
                const imgUrl = await generateImage(cat.imagePrompt + ', high quality, instagram reels vertical 9:16');
                createFinalImage(imgUrl, currentQuestion, cat);
                document.getElementById('s3').className = 'step done';
                await sleep(500);

                // STEP 4: Caption & Hashtags
                document.getElementById('s4').className = 'step active';

                const captionPrompt = `"${currentQuestion}" i√ßin Instagram Reels a√ßƒ±klamasƒ± yaz.

KURALLAR:
- CEVABI ASLA VERME
- Merak uyandƒ±r
- 2-3 kƒ±sa c√ºmle
- "Kaydetmeden ge√ßme" mutlaka olsun
- Profesyonel ama samimi
- Emoji kullan`;

                currentCaption = await callAI(captionPrompt);
                currentCaption = currentCaption.replace(/[\*\#\"]/g, '').trim();

                const hashtagPrompt = `"${currentQuestion}" i√ßin 12 T√ºrk√ße Instagram hashtag yaz. Sadece hashtag'leri virg√ºlle ayƒ±rarak yaz.`;
                let hashtags = await callAI(hashtagPrompt);
                hashtags = hashtags.match(/#[\wƒ±ƒü√º≈ü√∂√ßƒ∞ƒû√ú≈û√ñ√á]+/g) || [];

                document.getElementById('s4').className = 'step done';

                // Display results
                document.getElementById('outputBox').style.display = 'block';
                document.getElementById('questionBox').innerHTML = '‚ùì <strong>' + currentQuestion + '</strong>';
                document.getElementById('scriptBox').textContent = currentScript;
                document.getElementById('captionBox').textContent = currentCaption;
                document.getElementById('hashtagBox').innerHTML = hashtags.slice(0, 12).map(h => `<span class="hashtag">${h}</span>`).join('');
                document.getElementById('bestTime').textContent = 'üïê En iyi payla≈üƒ±m: 12:00-14:00 veya 19:00-21:00 (TR)';

            } catch (e) {
                alert('Hata: ' + e.message);
            }

            btn.disabled = false;
            btn.textContent = 'üîÑ YENƒ∞ Vƒ∞RAL ƒ∞√áERƒ∞K';
        }

        function sleep(ms) { return new Promise(r => setTimeout(r, ms)); }
        speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
    </script>
</body>

</html>
